<!DOCTYPE html>
<html lang="ko">
<head>
Â  <meta charset="UTF-8" />
Â  <title>ìˆ˜ë°• ê²Œì„ ğŸ‰</title>
Â  <style>
Â  Â  body {
Â  Â  Â  margin: 0;
Â  Â  Â  overflow: hidden;
Â  Â  Â  background: #fffbe6;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  height: 100vh;
Â  Â  Â  font-family: sans-serif;
Â  Â  Â  user-select: none;
Â  Â  }
Â  Â  canvas {
Â  Â  Â  background: #fef3c7;
Â  Â  Â  border: 5px solid #fcd34d;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  box-shadow: 0 4px 20px rgba(0,0,0,0.2);
Â  Â  }
Â  Â  #startBtn {
Â  Â  Â  position: absolute;
Â  Â  Â  padding: 10px 28px;
Â  Â  Â  font-size: 20px;
Â  Â  Â  background: #fcd34d;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: 0.2s;
Â  Â  }
Â  Â  #startBtn:hover { background: #fde047; }
Â  Â  #scoreboard {
Â  Â  Â  position: absolute;
Â  Â  Â  top: 10px;
Â  Â  Â  left: 10px;
Â  Â  Â  font-size: 18px;
Â  Â  Â  background: rgba(255,255,255,0.6);
Â  Â  Â  padding: 8px 12px;
Â  Â  Â  border-radius: 6px;
Â  Â  }
Â  </style>
</head>
<body>
Â  <button id="startBtn">ğŸ‰ ê²Œì„ ì‹œì‘</button>
Â  <div id="scoreboard">ì ìˆ˜: 0<br>ìµœê³ ì ìˆ˜: 0</div>
Â  <canvas id="gameCanvas" width="400" height="600"></canvas>

Â  <script>
Â  Â  const canvas = document.getElementById("gameCanvas");
Â  Â  const ctx = canvas.getContext("2d");
Â  Â  const startBtn = document.getElementById("startBtn");
Â  Â  const scoreboard = document.getElementById("scoreboard");

Â  Â  let gameRunning = false;
Â  Â  let fruits = [];
Â  Â  let dropping = null;
Â  Â  let mouseX = canvas.width / 2;
Â  Â  let score = 0;
Â  Â  let highScore = parseInt(localStorage.getItem("highScore") || "0");

Â  Â  // âœ… ìˆ˜ì •ë¨: restitution (ë°˜ë°œë ¥/íŠ•ê¹€) ì†ì„± ì¶”ê°€
Â  Â  const fruitTypes = [
Â  Â  Â  { name: "ì²´ë¦¬", color: "#ff4d6d", r: 12, gravity: 0.25, score: 1, restitution: 0.3 },
Â  Â  Â  { name: "ë”¸ê¸°", color: "#ff6384", r: 18, gravity: 0.3, score: 2, restitution: 0.28 },
Â  Â  Â  { name: "í¬ë„", color: "#a855f7", r: 26, gravity: 0.35, score: 4, restitution: 0.26 },
Â  Â  Â  { name: "ì‚¬ê³¼", color: "#ef4444", r: 35, gravity: 0.4, score: 8, restitution: 0.24 },
Â  Â  Â  { name: "ë ˆëª¬", color: "#fde047", r: 45, gravity: 0.45, score: 16, restitution: 0.22 },
Â  Â  Â  { name: "ë©œë¡ ", color: "#86efac", r: 55, gravity: 0.5, score: 32, restitution: 0.20 },
Â  Â  Â  { name: "ìˆ˜ë°•", color: "#16a34a", r: 65, gravity: 0.55, score: 64, restitution: 0.18 },
Â  Â  Â  { name: "íŒŒì¸", color: "#facc15", r: 75, gravity: 0.6, score: 100, restitution: 0.16 },
Â  Â  Â  { name: "ë³µìˆ­ì•„", color: "#fb7185", r: 85, gravity: 0.65, score: 200, restitution: 0.14 },
Â  Â  Â  { name: "ë§ê³ ", color: "#fbbf24", r: 95, gravity: 0.7, score: 400, restitution: 0.12 },
Â  Â  Â  { name: "ìš©ê³¼", color: "#ec4899", r: 110, gravity: 0.75, score: 800, restitution: 0.10 },
Â  Â  Â  { name: "ë‘ë¦¬ì•ˆ", color: "#84cc16", r: 130, gravity: 0.8, score: 1600, restitution: 0.08 }
Â  Â  ];

Â  Â  class Fruit {
Â  Â  Â  constructor(x, y, type) {
Â  Â  Â  Â  this.x = x;
Â  Â  Â  Â  this.y = y;
Â  Â  Â  Â  this.type = type;
Â  Â  Â  Â  this.r = type.r;
Â  Â  Â  Â  this.dy = 0;
Â  Â  Â  }
Â  Â  Â  draw() {
Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  ctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
Â  Â  Â  Â  ctx.fillStyle = this.type.color;
Â  Â  Â  Â  ctx.fill();
Â  Â  Â  Â  ctx.strokeStyle = "#fff";
Â  Â  Â  Â  ctx.lineWidth = 2;
Â  Â  Â  Â  ctx.stroke();
Â  Â  Â  Â  ctx.fillStyle = "#000";
Â  Â  Â  Â  ctx.font = "bold 14px sans-serif";
Â  Â  Â  Â  ctx.textAlign = "center";
Â  Â  Â  Â  ctx.fillText(fruitTypes.indexOf(this.type) + 1, this.x, this.y + 5);
Â  Â  Â  }
Â  Â  Â  update() {
Â  Â  Â  Â  this.dy += this.type.gravity;
Â  Â  Â  Â  this.y += this.dy;

Â  Â  Â  Â  // âœ… ìˆ˜ì •ë¨: ê³ ì •ê°’ -0.3 ëŒ€ì‹  ê³¼ì¼ë³„ restitution ê°’ ì‚¬ìš©
Â  Â  Â  Â  if (this.y + this.r > canvas.height) {
Â  Â  Â  Â  Â  this.y = canvas.height - this.r;
Â  Â  Â  Â  Â  this.dy *= -this.type.restitution; // íŠ•ê¹€ ì •ë„ë¥¼ ê³¼ì¼ í¬ê¸°(ì¢…ë¥˜)ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì ìš©
Â  Â  Â  Â  }

Â  Â  Â  Â  if (this.x - this.r < 0) this.x = this.r;
Â  Â  Â  Â  if (this.x + this.r > canvas.width) this.x = canvas.width - this.r;
Â  Â  Â  }
Â  Â  }

Â  Â  function spawnNewFruit() {
Â  Â  Â  const rand = Math.random() < 0.9 ? 0 : 1;
Â  Â  Â  dropping = new Fruit(mouseX, 100, fruitTypes[rand]);
Â  Â  }

Â  Â  canvas.addEventListener("mousemove", e => {
Â  Â  Â  const rect = canvas.getBoundingClientRect();
Â  Â  Â  mouseX = e.clientX - rect.left;
Â  Â  Â  if (dropping) dropping.x = mouseX;
Â  Â  });

Â  Â  canvas.addEventListener("click", () => {
Â  Â  Â  if (!gameRunning || !dropping) return;
Â  Â  Â  fruits.push(dropping);
Â  Â  Â  dropping = null;
Â  Â  Â  setTimeout(spawnNewFruit, 500);
Â  Â  });

Â  Â  function resetGame() {
Â  Â  Â  fruits = [];
Â  Â  Â  dropping = null;
Â  Â  Â  score = 0;
Â  Â  Â  gameRunning = true;
Â  Â  Â  startBtn.style.display = "none";
Â  Â  Â  spawnNewFruit();
Â  Â  Â  requestAnimationFrame(loop);
Â  Â  }

Â  Â  function updateScore(points) {
Â  Â  Â  score += points;
Â  Â  Â  if (score > highScore) {
Â  Â  Â  Â  highScore = score;
Â  Â  Â  Â  localStorage.setItem("highScore", highScore);
Â  Â  Â  }
Â  Â  Â  scoreboard.innerHTML = `ì ìˆ˜: ${score}<br>ìµœê³ ì ìˆ˜: ${highScore}`;
Â  Â  }

Â  Â  function checkCollision(a, b) {
Â  Â  Â  const dx = a.x - b.x;
Â  Â  Â  const dy = a.y - b.y;
Â  Â  Â  const dist = Math.hypot(dx, dy);
Â  Â  Â  return dist < a.r + b.r;
Â  Â  }

Â  Â  function mergeFruits() {
Â  Â  Â  for (let i = 0; i < fruits.length; i++) {
Â  Â  Â  Â  for (let j = i + 1; j < fruits.length; j++) {
Â  Â  Â  Â  Â  const a = fruits[i], b = fruits[j];
Â  Â  Â  Â  Â  if (a.type === b.type && checkCollision(a, b)) {
Â  Â  Â  Â  Â  Â  const idx = fruitTypes.indexOf(a.type);
Â  Â  Â  Â  Â  Â  if (idx < fruitTypes.length - 1) {
Â  Â  Â  Â  Â  Â  Â  const nx = (a.x + b.x) / 2;
Â  Â  Â  Â  Â  Â  Â  const ny = (a.y + b.y) / 2;
Â  Â  Â  Â  Â  Â  Â  fruits.splice(j, 1);
Â  Â  Â  Â  Â  Â  Â  fruits.splice(i, 1);
Â  Â  Â  Â  Â  Â  Â  fruits.push(new Fruit(nx, ny, fruitTypes[idx + 1]));
Â  Â  Â  Â  Â  Â  Â  updateScore(a.type.score);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  function loop() {
Â  Â  Â  if (!gameRunning) return;
Â  Â  Â  ctx.clearRect(0, 0, canvas.width, canvas.height);

Â  Â  Â  for (let f of fruits) f.update();

Â  Â  Â  // âœ… ìˆ˜ì •ë¨: ì¶©ëŒ ì‹œ ì§ˆëŸ‰(ë°˜ì§€ë¦„)ì— ë”°ë¼ ë°€ë ¤ë‚˜ëŠ” ì •ë„ë¥¼ ë‹¤ë¥´ê²Œ ê³„ì‚°
Â  Â  Â  for (let i = 0; i < fruits.length; i++) {
Â  Â  Â  Â  for (let j = i + 1; j < fruits.length; j++) {
Â  Â  Â  Â  Â  const a = fruits[i], b = fruits[j];
Â  Â  Â  Â  Â  const dx = a.x - b.x;
Â  Â  Â  Â  Â  const dy = a.y - b.y;
Â  Â  Â  Â  Â  const dist = Math.hypot(dx, dy);
Â  Â  Â  Â  Â  const minDist = a.r + b.r;
Â  Â  Â  Â  Â  if (dist < minDist) {
Â  Â  Â  Â  Â  Â  const overlap = (minDist - dist); // ê²¹ì¹œ ì´ ê±°ë¦¬
Â  Â  Â  Â  Â  Â  const nx = dx / dist; // ì¶©ëŒ ë°©í–¥ (normal x)
Â  Â  Â  Â  Â  Â  const ny = dy / dist; // ì¶©ëŒ ë°©í–¥ (normal y)

Â  Â  Â  Â  Â  Â  // ë°˜ì§€ë¦„(r)ì„ ì§ˆëŸ‰(mass)ìœ¼ë¡œ ê°„ì£¼í•˜ì—¬ ë°€ë ¤ë‚˜ëŠ” ë¹„ìœ¨ ê³„ì‚°
Â  Â  Â  Â  Â  Â  const mass_a = a.r;
Â  Â  Â  Â  Â  Â  const mass_b = b.r;
Â  Â  Â  Â  Â  Â  const total_mass = mass_a + mass_b;
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ë¬´ê±°ìš´ ê³¼ì¼(a)ì€ ì ê²Œ, ê°€ë²¼ìš´ ê³¼ì¼(b)ì€ ë§ì´ ë°€ë ¤ë‚¨
Â  Â  Â  Â  Â  Â  const push_a = overlap * (mass_b / total_mass);
Â  Â  Â  Â  Â  Â  const push_b = overlap * (mass_a / total_mass);

Â  Â  Â  Â  Â  Â  a.x += nx * push_a;
Â  Â  Â  Â  Â  Â  a.y += ny * push_a;
Â  Â  Â  Â  Â  Â  b.x -= nx * push_b;
Â  Â  Â  Â  Â  Â  b.y -= ny * push_b;

Â  Â  Â  Â  Â  Â  // ê¸°ì¡´ ì†ë„ ê°ì†ì€ ìœ ì§€ (ì•ˆì •ì„±)
Â  Â  Â  Â  Â  Â  a.dy *= 0.98;
Â  Â  Â  Â  Â  Â  b.dy *= 0.98;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  }

Â  Â  Â  mergeFruits();

Â  Â  Â  for (let f of fruits) f.draw();
Â  Â  Â  if (dropping) dropping.draw();

Â  Â  Â  // ê²Œì„ì˜¤ë²„ ì¡°ê±´
Â  Â  Â  if (fruits.some(f => f.y - f.r < 0)) {
Â  Â  Â  Â  gameRunning = false;
Â  Â  Â  Â  startBtn.style.display = "block";
Â  Â  Â  Â  startBtn.textContent = "ğŸ’€ ë‹¤ì‹œ ì‹œì‘";
Â  Â  Â  }

Â  Â  Â  requestAnimationFrame(loop);
Â  Â  }

Â  Â  startBtn.addEventListener("click", resetGame);
Â  Â  scoreboard.innerHTML = `ì ìˆ˜: 0<br>ìµœê³ ì ìˆ˜: ${highScore}`;
Â  </script>
</body>
</html>
